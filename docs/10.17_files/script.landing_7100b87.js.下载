define("tetris/parse/Form.js",function(t,e,i){function n(t){var e=this;this.siteOpt=t,this.$el=t.$el,this.$pieceEl=t.$el.parents(".form-piece"),this.formId=t.formId||this.$el.attr("form_id"),this.$submitbtn=this.$el.find('.btn-i[type="submit"]'),this.$reset=this.$el.find("#reset"),this.$jump=this.$el.find(".btn-jump"),this.$textarea=this.$el.find("textarea"),this.$input=this.$el.find('input[type = "text"]'),e.$layerBorder=this.$el.find(".layer-border"),this.DOMHeight=this.$el.height(),this.padding=20,this.showJump=t.showJump,this.successUrl=t.successUrl,this.failedUrl=t.failedUrl,this.recommendAdPageUrl=t.recommendAdPageUrl,this.successmsg=t.successmsg,this.isShowCount=t.isShowCount,this.locateBgColor=t.locateBgColor,this.countPos=t.countPos?parseInt(t.countPos):0,this.countKit=t.countKit||{},this.telAutoFill=t.telAutoFill,this.recentSubmitStyle=t.recentSubmitStyle,this.csrf=S.getCookie().csrftoken||this.$el.find('[name="csrfmiddlewaretoken"]').val()||"",this.$telInput="",this.preFillTelNum=null,this.submitTarget=null,this.submitedFormData="",this.prepareToSubmitData="",this.submitValueChanged=0,this.pointVerify=null,this.sliderVerify=null,this.userActionLogId=this.makeUniqueLogId(),this.submitLogId="",this.fieldsCount=this.$el.attr("fields-count")||"",this.isLayerForm=t.isLayerForm,this.firstHasSubmit=0,this.layerHasSubmit=0,this.isAutoFillSms=!1,this.TriggerAutoFill=!1,this.setPageType(),this.getCurrentPosition(),this.doCityCtr(),this.addEvent(),this.initCount(),this.renderRecentSubmitHistory(),this.sendWriteActionLog(),t.caculator&&(this.bindCaculatorLogical(t.caculator),this.caculatorDisplay=this.bindCaculatorDisplayEvent());var i=S.queryToJson(location.href);if(o=o||i.ad_id||0,s=s||i.req_id||"",S.isToutiao()){o=S.getLocationParam("ad_id"),s=S.getLocationParam("req_id"),r=S.getCidFromParam("cid");var n=window.sessionStorage||{};if("function"==typeof n.getItem&&(r=r||n.getItem("_tt_cid")||0,s=s||n.getItem("_tt_req_id")||0,l=n.getItem("_tt_user_id")||0,c=n.getItem("_tt_device_id")||0),!r)var a=setInterval(function(){window.ToutiaoJSBridge&&(clearInterval(a),S.getCid())},200);if(l)S.getMobileByUserId(l,function(){e.$el.trigger(h)});else var d=setInterval(function(){window.ToutiaoJSBridge&&(clearInterval(d),S.fetchUserInfo(function(){S.getMobileByUserId(l,function(){e.$el.trigger(h)})}))},200)}else{var u;try{u=JSON.parse(window.decodeURIComponent(S.getLocationParam("_toutiao_params")||"{}"))}catch(t){u={}}r=r||u.cid||"",l=l||u.uid||0,c=c||u.device_id||0}S.getAdUserDeviceInfo(),this.observeDOMHeight()}var a="/tetris/form/result/count/",o=0,r=0,s="",c=0,l=0,d=0,u="",f=!1,p="",h="g_user_mobile_ready",m=1,v="telFillStatus",g="lastTelNum",y="_tt_recent_submit_time",_="success",b="fail",w={add:"+",minus:"-",multiply:"*",divide:"/",leftParentheses:"(",rightParentheses:")"},S={getPageId:function(){var t=location.href.match(/tetris\/page\/(\d+)\//);return t&&t.length>1&&(d=t[1]),d},jsonToQueryString:function(t){return""+Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")},strToJson:function(t){for(var e,i,n,a,o=t.split("&"),r=o.length,s={},c=0;c<r;c++)o[c]&&(a=o[c].split("="),e=a[0],i=a[1],n=s[e],"undefined"==typeof n?s[e]=i:this.isArray(n)?n.push(i):s[e]=[n,i]);return s},queryToJson:function(t){var e=t.substr(t.lastIndexOf("?")+1);return this.strToJson(e)},isArray:function(t){return"[object Array]"===toString.call(t)},getCookie:function(){for(var t,e=document.cookie,i=e.split(";"),n=i.length,a=0,o={};a<n;a++)if(i[a]){t=i[a].split("=");var r=t[0].trim(),s=t[1];o[r]=s}return o},chinese2English:function(t){return t.indexOf("格式不正确")>=0?"format error":t.indexOf("已使用")>=0?"already exist":t.indexOf("为空")>=0?"cannot be empty":t.indexOf("时间的格式")>=0?"time format error":"NONE"},getLocationParam:function(t){var e={QueryString:function(t){var e=window.location.href,i=new RegExp("[&?]{1}"+t+"=([^&?|^#?]*)","ig");return e.match(i)?decodeURI(e.match(i)[0].substr(t.length+2)):(e=document.referrer,e.match(i)?decodeURI(e.match(i)[0].substr(t.length+2)):"")}};return e.QueryString(t)},isWebviewDialogUrl:function(){var t,e=/(revealType)(\=)(\w+)/g;t=window.location.href.match(e);var i=t&&t[0]?t[0].split("="):[];return!(!i[0]||"revealType"!==i[0]||!i[1]||"dialog"!==i[1])},isToutiao:function(){var t=document.referrer&&document.referrer.indexOf("//nativeapp.toutiao.com")>0||/(News|NewsSocial|Explore|NewsArticle|NewsInHouse|joke_essay|Joke|Video|VideoInHouse|VideoArticle|aweme|live_stream)( |\/|_)/i.test(navigator.userAgent);return t},getCidFromParam:function(){return S.getLocationParam("cid")},getCid:function(){var t=window.ToutiaoJSBridge||{};"function"==typeof t.call&&t.call("adInfo",{},function(t){t=t||{},r=r||t.cid||0})},fetchUserInfo:function(t){var e=window.ToutiaoJSBridge||{};"function"==typeof e.call&&e.call("appInfo",{},function(e){e=e||{},c=e.device_id||0,l=e.user_id||0,l&&t&&t(l)})},getMobileByUserId:function(t,e){},localValue:function(t,e){return arguments.length>1?localStorage.setItem(t,e):localStorage.getItem(t)},getAdUserDeviceInfo:function(t){var e={},i=setInterval(function(){try{window._taq&&window._taq.getCommonDataPromise&&(clearInterval(i),e=window._taq.getCommonDataPromise(),o=o||e.ad_id,e.adInfo||e.appInfo||(s=s||e.req_id,r=r||e.cid,l=l||e.user_id,c=c||e.device_id),e.adInfo&&"function"==typeof e.adInfo.then&&e.adInfo.then(function(t){s=s||t.req_id,r=r||t.cid}).catch(function(t){}),e.appInfo&&"function"==typeof e.appInfo.then&&e.appInfo.then(function(t){c=c||t.device_id,l=l||t.user_id}).catch(function(t){}))}catch(t){}},200)},fixedBody:function(){var t=document.body.scrollTop||document.documentElement.scrollTop;document.body.style.cssText+="position:fixed;top:-"+t+"px;"},looseBody:function(){var t=document.body;t.style.position="";var e=t.style.top;document.body.scrollTop=document.documentElement.scrollTop=-parseInt(e),t.style.top=""}},C={isLayerSubmitClicked:function(t){var e=$(t);return e.hasClass("is-layer")?1:0}},x={bindCaculatorLogical:function(t){function e(t){for(var e=0;e<t.length;e++){var n=t[e];"variable"===n.type?!function(t){var e=i.$el.find('input[uid="'+t.val+'"]');t._val=window.parseFloat(e.val()),e.on("change",function(){t._val=window.parseFloat(e.val())})}(n):"operator"===n.type?n._val=w[n.val]:n._val=n.val}}for(var i=this,n=0;n<t.length;n++)e(t[n].expr)},bindCaculatorDisplayEvent:function(){function t(){n&&(a.text(i[o++%4]),e(t))}var e=function(t){window.setTimeout(t,300)},i=["93663","837322","63846","7387"],n=!0,a=this.$el.find(".caculator-display"),o=0;return t(),{setVal:function(t){n=!1,a.text(t)}}},evalCaculatorExpression:function(t){for(var e="",i=0;i<t.length;i++){if(t[i]._val!==t[i]._val)return{status:"fail",result:this.$el.find('input[uid="'+t[i].val+'"]').parent().parent().children("#label").text()+"为空，无计算结果"};e+=t[i]._val}var n;try{n=Number(window.eval(e)),n=~~n===n?n:n.toFixed(2)}catch(t){console.log(t),n="非法的输入"}return"Infinity"===n?{status:"success",result:"∞"}:{status:"success",result:n}},formFocus:function(){window.location.hash="",window.location.hash=this.siteOpt.id},evalCaculator:function(t){this.$el.find(".caculator-warn").text("");for(var e=0;e<t.length;e++){var i=this.evalCaculatorExpression(t[e].expr);if("success"!==i.status)return void this.$el.find(".caculator-warn").text(i.result);this.$el.find('.caculator-item[uid="'+t[e].uid+'"] .caculator-val').text(i.result),0===e&&"∞"!==i.result&&this.caculatorDisplay.setVal(i.result)}this.formFocus()},setPageType:function(){var t=this,e=$("#creative-title"),i=($("#submit-result"),e.length>0),n=navigator.userAgent.match(/RevealType\/Dialog/i),a=n||S.isWebviewDialogUrl();p=i&&a?t.pageType="creative":t.pageType="normal"},isCreativePage:function(){return"creative"===this.pageType},layerEvent:function(){var t=this.$layerWrapper=this.$pieceEl.find(".layerform-notice-wrapper"),e=t.find(".form-extra-elements-wrapper");t.find(".notice-part");e.length&&(t.addClass("form-piece"),$(document.body).append(t),this.siteOpt.isLayerForm=1,t.on("click",function(e){$(e.target).hasClass("close-icon")&&(t.addClass("hide"),S.looseBody())}))},makeUniqueLogId:function(){return this.formId+"-"+this.csrf+"-"+ +new Date},genUUID:function(t){t=t||32;for(var e="abcdefghijklmnopqrstuvwxyz0123456789",i=e.length,n="",a=0;a<t;a++)n+=e.charAt(Math.floor(Math.random()*i));return n},addToSeedTrack:function(t,e){window.seed.track({component_type:"form",component_id:this.formId,action_type:t,action_value:e})},addToTetrisAction:function(t,e){window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:this.formId,action_type:t,action_value:e})},sendWriteActionLog:function(){var t=this;$("form input").on("input",function(){f||(window.addTetrisAction({component_type:"form",component_id:t.formId,action_type:"form_write",action_value:"1"}),f=!0)})},sendFormAutoFillLog:function(t,e){window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:this.formId,action_type:t,action_value:e})},sendFormSubmitWithAutoFillLog:function(t){window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:this.formId,action_type:"submit_with_tel_autofill_"+t,action_value:this.TriggerAutoFill?"1":"0"})},removeFormAutoFillLog:function(){window.removeTetrisAction&&window.removeTetrisAction("form","trigger_tel_autofill")},doCityCtr:function(){if(this.$city=this.$el.find(".city-group"),this.$city&&this.$city.length){this.city=[],this.cityData=JSON.parse(this.$city.attr("city-data"));for(var t=this.cityData.cities,e=this.cityData.codes,i=this,n=t.length,a=0;a<n;a++){var o=t[a],r={name:o,code:e[a]};i.city.push(r)}var s=this.$city.find("#pro");s.bind("change",function(t){i.initCity($(this).val())}),this.initCity(s.val()),this.fillCurrentLocation(this.cityData)}},getCurrentPosition:function(t){var e=this;if(e.addressInfo)return void(t&&t(e.addressInfo));setTimeout(function(){window.ToutiaoJSBridge&&window.ToutiaoJSBridge.call("get_address",{},function(i){i=i||{},e.addressInfo=i||{},t&&t(e.addressInfo)})},100)},fillCurrentLocation:function(t){var e=function(t){var e="";return t.indexOf("省")>-1&&(e=t.slice(0,t.indexOf("省"))),t.indexOf("市")>-1&&(e=t.slice(0,t.indexOf("市"))),e};setTimeout(function(){this.getCurrentPosition(function(i){if(i.address_info){var n=e(i.address_info.province||""),a=e(i.address_info.locality||""),o=t.cities.toString().indexOf(n)!==-1,r=t.cities.toString().indexOf(a)!==-1;n&&a&&o&&r&&($(".city-group-province").find("select").val(n).change(),$(".city-group-city").find("select").val(a).change())}})}.bind(this),300)},addEvent:function(){this.jumpBtnEvent(),this.multiSelectEvent(),this.radioSelectEvent(),this.chkboxSelectEvent(),this.submitEvent(),this.captchaEvent(),this.placeholderEvent(),this.validateEvent(),this.autocompleteEvent(),this.telPhoneAutoFillEvent(),this.clearInputEvent(),this.formBehaviorEvents(),this.captchaDialogEvent(),this.layerEvent()},normalizeFieldName:function(t){var e=$(t),i=e.attr("name");return i&&/^[0-9]+$/.test(i)?i:e.closest(".need-serialize").length?e.closest(".need-serialize").attr("name"):e.closest(".selectMulti-group").length?e.closest(".selectMulti-group").children("input[name]").attr("name"):/^(radio|checkbox)-/.test(i||"")?e.closest(".radio-group, .checkbox-group").children("input[name]").attr("name"):"ANONYMOUS"},normalizeFieldValue:function(t){var e=$(t),i=this.normalizeFieldName(e),n=this.$el.find('[name="'+i+'"]');if(n.hasClass("need-serialize")){var a=n.find("input, select").map(function(t,e){return $(e).val()});return[].slice.call(a).join("+")}return n.val()},normalizeFieldType:function(t){var e=$(t),i=e.attr("eletype");return i?i:e.attr("type")?e.attr("type"):e.hasClass("form-date")?"date":e.closest(".gender-group").length?"gender":e.closest(".city-group").length?"city":e.closest(".textarea-group").length?"textarea":e.closest(".selectMulti-group").length?"select":void 0},formBehaviorEvents:function(){var t=this,e=[],i=[];this.getModelBehavitors=function(){return e},this.addBehavEvents=function(t){a(t)},this.addToAllBehvs=function(i){e.push(i),window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:t.formId,action_type:i.et,action_value:JSON.stringify(i)})},this.addToFormBehvs=function(t){i.push(t)},this.getFormatModelBehaviors=function(){var t={impression:"00",field_focus:"01",field_change:"02",field_blur:"03",submit:"10"},i={form:"00",name:"01",telphone:"02",captcha:"03",email:"04",date:"05",input:"06",text:"06",select:"07","select-one":"07",city:"08",radio:"09",checkbox:"10",gender:"11",textarea:"12",submit:"99"};return __modelBehaviorsarr=e.map(function(e){var n=[],a=e.tm;return n[0]=a,n[1]=t[e.et]+(i[e.t]||""),"impression"===e.et?(n[2]=e.ltm,n[3]=e.top):(n[2]=e.n||"",n[3]=e.v||""),n}),__modelBehaviorsarr};var n=null,a=function(i,n){var a=this.normalizeFieldName(n),o=(new Date).getTime();if("field_focus"===i){var r=e.slice(-1).pop();if(r&&"field_blur"===r.et&&r.n===a)return void(e=e.slice(0,-1))}if("submit"===i)return void this.addToAllBehvs({et:i,tm:o,t:"submit",v:t.fieldsCount});if("ANONYMOUS"!==a&&(this.addToAllBehvs({et:i,t:this.normalizeFieldType(n),n:a,v:this.normalizeFieldValue(n),tm:o}),e.length>=15)){var s=(e.length,[].concat(e));$.ajax({url:"/tetris/form/collect_uac/",type:"POST",csrf:t.csrf,data:{csrfmiddlewaretoken:t.csrf,uacid:t.userActionLogId,uaclist:JSON.stringify(t.getFormatModelBehaviors())},success:function(t){},error:function(){e=s.concat(e)}}),e=[]}}.bind(this);this.$el.on("focusin",function(t){var e=this.normalizeFieldName(t.target);n&&n===e||(n=e,a("field_focus",t.target))}.bind(this)).on("focusout",function(t){n=null,a("field_blur",t.target)}.bind(this)).on("change","input, textarea, select",function(t){a("field_change",t.target)}.bind(this)).on("FORM_SUBMIT_CLICK",function(t){var e=$(t.target);e.hasClass("layer-submit")}.bind(this)),window.addEventListener("beforeunload",function(){"function"==typeof window.addTetrisAction}.bind(this)),window.addEventListener("load",function(){function i(t){var e=t.getBoundingClientRect();return e.top>0&&e.top<o||e.top<=0&&e.bottom>0&&e.bottom<o}function n(t){var e=t.getBoundingClientRect().top+window.scrollY;return parseFloat((e/o).toFixed(2))}var a=Date.now(),o=window.innerHeight,r=this.$el.get(0);window.performance&&window.performance.timing&&(a=performance.timing.domInteractive);var s=i(r),c=0;if(s)return e.push({et:"impression",ltm:a,top:0,t:"form",tm:+new Date}),void(c=1);var l,d,u=function(){i(r)&&(c||(t.addToAllBehvs({tm:+new Date,et:"impression",t:"form",ltm:a,top:n(r)}),c=1),window.removeEventListener("scroll",d))};d=function(){clearTimeout(l),l=setTimeout(u,50)};var f=!1;try{var p=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("test",null,p)}catch(t){}window.addEventListener("scroll",d,!!f&&{passive:!0})}.bind(this))},placeholderEvent:function(){this.$el.find("input,textarea").focus(function(t){$(this).siblings(".style2-placeholder")&&$(this).siblings(".style2-placeholder").length>0&&($(this).siblings(".style2-placeholder")[0].style.display="none")}).blur(function(){$(this).siblings(".style2-placeholder")&&$(this).siblings(".style2-placeholder").length>0&&""==$(this).val().trim()&&($(this).siblings(".style2-placeholder")[0].style.display="block",$(this).val(""))})},submitEvent:function(){var t=this;t.ajaxLock=!1,t.$submitbtn.bind("click",function(e){r=r||sessionStorage.getItem("_tt_cid")||0,s=s||sessionStorage.getItem("_tt_req_id")||sessionStorage.getItem("umeng_req_id")||0;({g_ad_id:o,g_req_id:s,g_cid:r,g_user_id:l,_tt_cid:sessionStorage.getItem("_tt_cid"),ocpc:window._taq.get_query({event_type:"normal",event_value:"from_feed_dialog"})});e.preventDefault(),t.ajaxLock||(t.doSubmit(e.currentTarget),t.ajaxLock=!0,setTimeout(function(){t.ajaxLock=!1},5e3))})},jumpBtnEvent:function(){var t=this.showJump,e=this;+new Date;"1"==t&&(this.$jump.removeClass("hide"),this.$jump.css({"background-color":e.locateBgColor}),this.$jump.bind("click",function(t){var i=e.$el.offset(),n=i.top;window.scrollTo(0,n),e.addTetrisAction("anchor","anchor")})),$(".create-left-content").length?$(".create-left-content").append(this.$jump):$('<div class="create-left-content"/>').append(this.$jump).appendTo("main"),$(".create-right-content").length?$(".create-right-content").append(this.$jump):$('<div class="create-right-content"/>').append(this.$jump).appendTo("main")},sendActionLog:function(t,e){var i=this;"function"==typeof window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:i.formId,action_type:t,action_value:e})},getSmsinfo:function(t){},captchaEvent:function(){var t=this,e=t.$el.find(".sms-validate");if(0!==e.length){var i=t.$el.find(".sms-pic-validate-wrapper"),n=i.find("img"),a=t.$el.find(".sms-info"),o=t.$el.find(".close");i.attr("pic-validate","0");var r=e.find(".send-sms"),s=i.find(".send_sms_validate");i.find(".refresh-pic-btn").click(function(){n.attr("src",n.attr("origin-src")+"&_t="+ +new Date)}),o.on("click",function(){i.addClass("hide")}),i.on("click",function(t){$(t.target);t.target===t.currentTarget&&i.addClass("hide")}),s.on("click",function(n){var o=e.parents(".input-group-i").find("input"),r=o.length>0?o.val():"";$.ajax({url:"/tetris/send_captcha/",type:"POST",data:{cvalue:i.find("input").val(),ckey:i.attr("captcha_key"),phone_number:r,csrfmiddlewaretoken:t.csrf},beforeSend:function(e){e.setRequestHeader("X-CSRFToken",t.csrf)},success:function(e){e.status===_?(1===e.pic_captcha||1===e.picCaptcha?a.text(e.msg||"请输入图形验证码"):i.addClass("hide"),t.sendActionLog("sendCaptchaSuccess",e.status)):(a.text(e.msg||"短信发送失败"),t.sendActionLog("sendCaptchaFail",e.msg))},error:function(){a.text(rs.msg||"短信发送失败"),t.sendActionLog("sendCaptchaFail",rs.msg)}})}),r.on("click",function(){if(!$(this).hasClass("disabled")){var n=e.parents(".input-group-i").find("input").val();return 11==n.trim().length&&/\d{11}/.test(n)?"1"==i.attr("pic-validate")?(a.text("请输入图形验证码"),i.find("input").val(""),void i.removeClass("hide")):void $.ajax({url:"/tetris/send_captcha/",type:"POST",data:{phone_number:n,csrfmiddlewaretoken:t.csrf},beforeSend:function(e){e.setRequestHeader("X-CSRFToken",t.csrf)},success:function(e){if(e.data&&!e.data.captcha_key&&(i.addClass("hide"),t.makeCountDownBtn(r),t.sendActionLog("sendCaptchaSuccess",JSON.stringify(e.data.captcha_key))),e.data&&e.data.captcha_key){i.attr("pic-validate","1");var n=i.find("img");n.attr("src",e.data.captcha_url+"&_t="+ +new Date),n.attr("origin-src",e.data.captcha_url),i.attr("captcha_key",e.data.captcha_key),i.removeClass("hide"),a.text("请输入图形验证码")}e.msg&&TTNotice.create($("body"),{content:e.msg||"短信发送失败",type:1})}}):void TTNotice.create($("body"),{content:"电话号码应为11位数字",type:1})}})}},multiSelectEvent:function(){var t=this,e=this.$el.find(".selectMulti-group");e.length&&e.each(function(){function e(t,a){if(t&&t.length){var o=n.arrObj[a];if("checked"==o.type?(t[0].dataset.checkbox="1",t.addClass("select-checkbox")):(t.removeClass("select-checkbox"),t[0].dataset.checkbox="",t.removeAttr("data-checkbox")),i(t),"0"===a)t.hide().removeClass("showing"),e(t.next(),"0");else{var r=0;if(o&&o.sid)if(o.type){if("checked"==o.type){var s=$('<div class="cb-wrapper"></div>');t.append(s),s.empty(),o.sid.forEach(function(t){var e=n.arrObj[t];r=1;var i='<label class="cbx-item"><input type="checkbox" id="{{item_id}}" value="{{item_value}}"/>{{item_text}}</label>';i=i.replace("{{item_id}}",e.id),i=i.replace("{{item_value}}",e.text),i=i.replace("{{item_text}}",e.text);var a=$(i);s.append(a)})}}else o.sid.forEach(function(e){var i=n.arrObj[e];r=1;var a=document.createElement("option");a.dataset.id=i.id,a.value=i.text,a.text=i.text,t.find("select")[0].add(a,null)});r?t.show().addClass("showing"):t.hide().removeClass("showing"),e(t.next(),"0")}}}function i(t){var e=t.find("select"),i=t.find(".cb-wrapper");e[0].value="",e[0].options&&(e[0].options.length=0);var n=document.createElement("option");n.dataset.id="0",n.value="null",n.text="--请选择--",e[0].add(n,null),i&&i.remove()}var n,a,o,r,s=$(this);try{n=s.attr("data-select"),n=JSON.parse(n)}catch(t){}if(s){$selectWrappers=s.find(".select-wrapper"),o=s.find(".select-list1"),a=s.find("select"),r=s.find(".multi-select");var c,l={};$selectWrappers.hide().removeClass("showing"),o.show().addClass("showing"),function(i){a.on("change",function(n){for(var a,o,s=n.target,d=$(this).val(),u=($(this).index(),Array.prototype.slice.call(s.options)),f=0;f<u.length;f++)u[f].value===d&&(a=u[f].dataset.id);o=$(this).parent().next(),e(o,a),l=t.getSelectValue(i),c=function(){var t="";for(var e in l)t=t+l[e]+",";return t=t.slice(0,t.length-1)}(),r.val(c)})}($selectWrappers),function(e){s.on("change",'input[type="checkbox"]',function(i){l=t.getSelectValue(e),c=function(){var t="";for(var e in l)t=t+l[e]+",";return t=t.slice(0,t.length-1)}(),r.val(c)})}($selectWrappers)}})},getSelectValue:function(t){var e=t.filter(".showing"),i={};return e.each(function(t){if("1"==$(this)[0].dataset.checkbox){var e=$(this).children(".cb-wrapper"),n=[];e&&e.children().each(function(t,e){var i=$(e);i.children("input").prop("checked")&&n.push(i.children().val())}),i[t+1]="["+n.toString()+"]"}else i[t+1]=$(this).children("select").val()||"null"}),"null"===i[1]&&(i={}),i},radioSelectEvent:function(){var t=this.$el.find(".radio-group");t.each(function(){var t=$(this),e=t.find('input[type="radio"]'),i=t.find("input.radio-select");e.on("change",function(e){var n=t.find('input[type="radio"]:checked');i.val(n.val())}.bind(this))})},chkboxSelectEvent:function(){var t=this.$el.find(".checkbox-group");t.each(function(){var t=$(this),e=t.find('input[type="checkbox"]'),i=t.find("input.checkbox-select");e.on("change",function(e){var n=t.find('input[type="checkbox"]:checked'),a=[];$.each(n,function(t,e){a.push(e.value)}),i.val(a.toString())}.bind(this))})},captchaDialogEvent:function(){var t=this,e=t.$el.find(".spam-user-validate-wrapper"),i=t.$el.find(".spam-user-validate-dialog");t.$spamUserWrapper=e,t.$spamUserDialog=i,$(document.body).append(e);var n=i.find(".spam-send-sms"),a=i.find(".pic-validate"),o=i.find("input.spam-pic-captcha"),r=i.find("input.spam-sms-captcha"),s=i.find(".validate-img"),c=i.find(".spam-refresh-pic-btn"),l=i.find(".spam-submit"),d=i.find(".spam-info"),u=i.find(".close"),f=function(){e.addClass("hide"),S.looseBody()};u.on("tap",function(t){f()}),e.on("click",function(t){t.target===t.currentTarget&&f()}),o.one("input",function(){t.addToTetrisAction("fill","pic")}),r.one("input",function(){var e=a.hasClass("hide")?"captcha":"piccaptcha";t.addToTetrisAction("fill",e)}),c.on("tap",function(t){s.attr("src",s.attr("origin-src")+"&_t="+ +new Date)}),n.on("tap",function(e){var r=$(e.currentTarget),c=l.attr("need-pic-validate"),u=i.find(".spam-pic-captcha").val()||"";if(!r.hasClass("disabled")){if(c&&0===u.length)return void d.text("请输入图形验证码");t.makeCountDownBtn(n),$.ajax({url:"/tetris/tetris_send_captcha/",type:"POST",data:{cvalue:o.val()||"",ckey:s.attr("captcha_key")||"",phone_number:n.attr("phone-number"),csrfmiddlewaretoken:t.csrf},beforeSend:function(e){e.setRequestHeader("X-CSRFToken",t.csrf)},success:function(e){e.status!=_&&(d.html(e.data.msg||e.msg),!e.data||1!==e.data.picValidateErr&&1!==e.data.picCaptcha?a.addClass("hide"):(l.attr("need-pic-validate","1"),s.attr("src",e.data.captcha_url),s.attr("origin-src",e.data.captcha_url),s.attr("captcha_key",e.data.captcha_key),d.text(e.msg||"图形验证码错误"),a.removeClass("hide"),t.clearCountDownBtn(n))),d.html(e.msg||e.data.msg||""),t.sendActionLog("sendCaptchaSuccess",e.data.msg)}})}}),l.on("tap",function(e){var n=e.target;t.submitTarget=n;var o=i.find(".spam-sms-captcha").val()||"";l.attr("need-pic-validate"),i.find(".spam-pic-captcha").val()||"";if(!o||0===o.length)return void d.text("请输入短信验证码");t.prepareToSubmitData=t.getAllSubmitData(),t.prepareToSubmitData.spam_sms_validate=o,t.sendSubmitRequest(l[0]);var r=a.hasClass("hide")?"captcha":"piccaptcha";t.addToTetrisAction("submit",r)})},saveTelToLocal:function(){var t=this.$inputTel.val()||"";t&&localStorage.setItem(g,t)},validateEvent:function(){var t=this;t.isCreativePage()||this.$el.on("blur",".input-group-i[validate] .m-input-text > input",function(t){var e=$(t.target),i=e.attr("validate");""!==i&&this.validateHandler(e,i)}.bind(this))},validateHandler:function(t,e){function i(t){this.message=t,this.stack=""}var n=$.trim(t.val());if(t.val(n),""===n)return void this.emptyMessage(t);i.prototype=Error.prototype;var a={name:function(t){var e=/^([\u4e00-\u9fa5]{1,6}|[a-zA-Z]{1,10}(\s+[a-zA-Z]{1,10})*)$/;return e.test(t)?null:new i("姓名格式不正确，请重新输入")},cellphone:function(t){t=t.replace(/[\s]/g,"");var e=/^(0\d{2,3})-?\d{7,8}$/,n=/^1[3-9][0-9][- ]?[0-9]{4}[- ]?[0-9]{4}$/;return e.test(t)||n.test(t)?null:new i("电话格式不正确，请重新输入")},captcha:function(t){var e=/^1[3-8][0-9][- ]?[0-9]{4}[- ]?[0-9]{4}$/;return e.test(t)?null:new i("手机格式不正确，请重新输入")},email:function(t){var e=/^[a-zA-Z0-9.!#$%&’*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;return e.test(t)?null:new i("邮箱格式不正确，请重新输入")},number:function(t){var e=/^(\d+\.)?\d+$/;return e.test(t)?null:new i("数值格式不正确，请重新输入")}};if(a[e]){var o=a[e](n);o instanceof Error?this.displayMessage(t,o.message):this.emptyMessage(t)}},displayMessage:function(t,e){var i=t.closest(".input-group-i[validate]").children(".form-control-error");i.length||(i=t.closest(".input-group-i[validate]").append('<span class="form-control-error"></span>').find(".form-control-error")),i.text(e)},emptyMessage:function(t,e){var i=t.closest(".input-group-i[validate]").children(".form-control-error");i.remove()},autocompleteEvent:function(){var t=!1,e=function(e){if(!t){var i=$(e.target),n=i.closest(".input-group-i[validate]"),a=$.trim(n.attr("validate")),o=$.trim(i.val());""!==a?this.showAutocomplete(i,a,o):(t=!1,this.hideAutocomplete(i))}}.bind(this);this.$el.on("compositionstart",function(){t=!0}).on("compositionend",function(i){t=!1,e(i)}).on("input",".input-group-i[validate] input",e)},showAutocomplete:function(t,e,i){var n={email:function(t){if(t.length<3)return[];var e=["163.com","126.com","qq.com","sina.com","sina.cn","gmail.com"];return t=t.split("@"),$.trim(t[1])&&(e=e.filter(function(e){return~e.indexOf($.trim(t[1]))})),$.map(e,function(e){return t[0]+"@"+e})},name:function(t){if(!t||t.length>1)return[];var e=["先生","女士"];return e.map(function(e){return t+e})}};if(n[e]){var a=n[e](i);if(!a.length)return void this.hideAutocomplete(t);var o=t.siblings(".form-autocomplete-list");if(!o.length){var r=$(t);o=t.after('<div class="form-autocomplete-list"></div>').siblings(".form-autocomplete-list"),o.one("click mousedown",".form-autocomplete-item",function(e){e.stopPropagation(),t.val($(e.target).data("value")),this.hideAutocomplete(t),setTimeout(function(){try{t.focus()}catch(t){}},0)}.bind(this)),r.one("blur",function(e){setTimeout(function(){this.hideAutocomplete(t)}.bind(this),0)}.bind(this))}o.empty(),o.append(a.map(function(t){return'<div class="form-autocomplete-item" data-value="'+t+'">'+t+"</div>"}).join(""))}},hideAutocomplete:function(t){t.siblings(".form-autocomplete-list").remove()},telPhoneAutoFillEvent:function(){var t=this;m=+(localStorage.getItem(v)||1);var e=this.$el.find(".input-group-i");e=e.filter(function(){return $(this).attr("validate")&&("cellphone"==$(this).attr("validate")||"captcha"==$(this).attr("validate")||"captchav2"==$(this).attr("validate"))});var i=this.$inputTel=e.children("div.m-input-text").children("input");t.$el.on(h,function(){var e=u.replace(" ","").replace("-","");1==m&&t.doTelAutoFill(t.$inputTel,e)});var n=$(".form-tel-autofillbtn"),a=n.find("input");1==m&&a.attr("checked",!0),a.click(function(e){var n=$(e.target);n.is(":checked")?(localStorage.setItem(v,1),t.doTelAutoFill(i,u),t.sendFormAutoFillLog("click_check","1"),t.TriggerAutoFill=!0):(localStorage.setItem(v,2),t.sendFormAutoFillLog("click_check","0"),t.TriggerAutoFill=!1),e.stopPropagation()})},doTelAutoFill:function(t,e){var i=this;e?(t.val(e),i.TriggerAutoFill=!0,window.addTetrisAction({component_type:"form",component_id:i.formId,action_type:"trigger_tel_autofill",action_value:"1"})):t.val("")},clearInputEvent:function(){var t=this,e=$(".m-input-text").children("span.el-input-clear");e.on("click",function(e){var i=$(e.target),n=i.prev(),a=n.val();n.val(""),"cellphone"==n.attr("validate")&&(t.isCreativePage()?a&&t.sendFormAutoFillLog("click_delete","1_"+a):a&&t.sendFormAutoFillLog("click_delete","2_"+a),t.TriggerAutoFill=!1),e.stopPropagation(),e.preventDefault()})},ocpcQuery:function(t,e){if(!window._taq||"function"!=typeof window._taq.get_query)return"";var i=window._taq.get_query({event_type:t,event_value:e});return i.source="tetris",window.encodeURIComponent(S.jsonToQueryString(i))},doSubmit:function(t){var e=this;return e.submitTarget=t,C.isLayerSubmitClicked(t)&&e.$layerBorder.after(e.$layerWrapper.addClass("hide")),this.$el.trigger("FORM_SUBMIT_CLICK",{target:t}),e.addBehavEvents("submit"),e.serializeData=e.$el.serialize().replace(/[^&]+=&/g,"").replace(/&[^&]+=$/g,"").replace(/&=[^&]*/g,""),e.prepareToSubmitData=e.getAllSubmitData(t),e.sendSubmitRequest(t),!1},getAllSubmitData:function(t){var e=this,i=e._getExtendSubmitData(t),n=e._getSubmitAjaxData(),a=e.serializeData+"&"+S.jsonToQueryString(n),o=Base64.encode(a);return $.extend({csrfmiddlewaretoken:e.csrf,ajax_data:o,behaviors:JSON.stringify(e.getFormatModelBehaviors())},i)},_getSubmitAjaxData:function(){var t=this,e={form_id:t.formId,page_id:S.getPageId(),req_id:s,cid:r,ad_id:o,user_id:l,device_id:c,localInfo:JSON.stringify(t.addressInfo||{})};t.submitLogId&&(e.log_id=t.submitLogId),t.$el.find(".need-serialize").each(function(t,i){var n=$(i),a="";n.find("input,select").each(function(t,e){a+=$(e).val()+"+"}),a=a.substring(0,a.length-1),e[n.attr("name")]=a}),window.getTetrisAction&&"function"==typeof window.getTetrisAction&&(e.stay_time=(window.getTetrisAction("page","stay_time")||{}).action_value||"",e.page_length=(window.getTetrisAction("page","browse_pages")||{}).action_value||"",e.page_read_pct=(window.getTetrisAction("page","read_pct")||{}).action_value||""),localStorage.getItem(y)&&(e.recent_submit_time=localStorage.getItem(y)||"");var i="form",n="normal";t.isCreativePage()&&(n="from_feed_dialog"),$(t.submitTarget).hasClass("is-layer")&&(i="form_deep");var a=t.ocpcQuery(i,n);return a&&(e.send=a),e},_getExtendSubmitData:function(t){var e=this;e.submitedFormData!=e.serializeData?(e.submitValueChanged=1,C.isLayerSubmitClicked(t)||(e.submitLogId=e.makeUniqueLogId()),e.hasInterrupt=""):e.submitValueChanged=0;var i={page_type:e.pageType,support_submit_check:e.isCreativePage()?0:1,spam:e.spamed||"",newValue:e.submitValueChanged,log_id:e.submitLogId,req_id:s,uacid:e.userActionLogId};return e.isLayerForm&&(C.isLayerSubmitClicked(t)?(i.isLayer=2,i.spam=0):i.isLayer=1),i},sendSubmitRequest:function(t){var e=this;e.submitedFormData=e.serializeData,$.ajax({type:"POST",url:"/tetris/form/submitv2/",data:e.prepareToSubmitData,success:function(i){e.ajaxLock=!1;i.status===_?(e.siteOpt.caculator&&e.evalCaculator(e.siteOpt.caculator),e.submitValueChanged=0,C.isLayerSubmitClicked(t)?e.layerHasSubmit=1:e.firstHasSubmit=1,e.trackSubmitLog(i,t),e.showOrHideSpamDialog(i),e.formSuccessAlertOrJump(),e.addCount(),e.sendFormSubmitWithAutoFillLog(e.pageType),e.isAutoFillSms&&e.sendActionLog("AutoFillSubmitSuccess",e.isAutoFillSms),!e.isAutoFillSms&&e.sendActionLog("unAutoFillSubmitSuccess",e.isAutoFillSms),e._finishSubmit(t)):(e.showTextSliderCaptchaIfNeeded(i),e.validateCallback(i),e.showOrHideSpamDialog(i),e.spamed=i.data&&i.data.spam?i.data.spam:0,e.isCreativePage()&&toutiao.formDialogClose({submit_result:0,success:function(t){console.log("success: "+JSON.stringify(t))},fail:function(t){console.log("fail: "+JSON.stringify(t))},error:function(t){console.log("error: "+JSON.stringify(t))}}))},error:function(){e.ajaxLock=!1}})},showTextSliderCaptchaIfNeeded:function(t){function e(){var e=document.getElementById(r);e&&(e.style.display="block",1===t.data.need_captcha&&console.log("bytedance://disable_swipe"))}function i(){r&&(document.getElementById(r).style.display="none",
1===t.data.need_captcha&&console.log("bytedance://enable_swipe"))}function n(){o.pointVerify&&(o.pointVerify.hide(),o.pointVerify=null),o.sliderVerify&&(o.sliderVerify.hide(),o.sliderVerify=null),i(),o.prepareToSubmitData=o.getAllSubmitData(),o.prepareToSubmitData.finger_print=S.getCookie().s_v_web_id,o.prepareToSubmitData.captcha_id=c,o.sendSubmitRequest()}function a(t,e){for(var i in e)t[i]=e[i]}var o=this;if(t.status!==_&&t.data.need_captcha){var r,s,c=this.genUUID(32),l={host:"https://verify.snssdk.com",aid:"1483",lang:"zh",app_name:"橙子建站",successCb:n,errorCb:i};if(2===t.data.need_captcha){if("function"!=typeof Points)return;r="text_captcha_container",s="1002",a(l,{ele:"text_captcha_inner",external:JSON.stringify({captcha_id:c,log_id:o.submitLogId,type:s}),challenge_code:s,toolbarBackColor:"#fff",refreshFontColor:"#4A90E2",refreshIconColor:"#4A90E2",subBackColor:"#4A90E2",subFontColor:"#fff",validatePassBackColor:"#A0CC49",validateFailBackColor:"#EB2F2F"}),this.pointVerify=new Points(l),this.pointVerify.init(),e(),this.pointVerify.show()}else if(1===t.data.need_captcha){if("function"!=typeof SliderVerification)return;r="slider_captcha_container",s="1001",a(l,{ele:"slider_captcha_inner",external:JSON.stringify({captcha_id:c,log_id:o.submitLogId,type:s}),challenge_code:s,toolbarBackColor:"#fff",promptBackColor:"#F0F0F0",promptFontColor:"#808080",refreshFontColor:"#4A90E2",refreshIconColor:"#4A90E2",validatePassBackColor:"#A0CC49",validateFailBackColor:"#EB2F2F"}),this.sliderVerify=new SliderVerification(l),this.sliderVerify.init(),e(),this.sliderVerify.show()}}},showOrHideSpamDialog:function(t){var e=this,i=e.$spamUserWrapper;if(0!==i.length)if(t.status!==_&&t.data.formSubmitCheck){var n=i.find(".pic-validate"),a=i.find(".validate-img"),o=i.find(".spam-send-sms"),r=i.find(".spam-info"),s=i.find(".spam-sms-captcha"),c=i.find(".spam-pic-captcha"),l=i.find(".spam-submit");r.html(t.data.msg||t.msg),o.attr("phone-number",t.data.phone_number),e._form_check_uac_log(t),1!==t.data.pic_captcha&&1!==t.data.picCaptcha||(n&&n.removeClass("hide"),a.attr("src",t.data.captcha_url),a.attr("origin-src",t.data.captcha_url),a.attr("captcha_key",t.data.captcha_key),l.attr("need-pic-validate","1")),i.hasClass("hide")&&(i.removeClass("hide"),c.val(""),s.val(""),S.fixedBody()),0===t.data.sentStatus?(e.makeCountDownBtn(o),e.addToTetrisAction("show","captcha")):1===t.data.sentStatus&&(1===t.data.pic_captcha||1===t.data.picCaptcha?(e.clearCountDownBtn(o),e.addToTetrisAction("show","piccaptcha")):e.makeCountDownBtn(o))}else t.status===_&&(i.addClass("hide"),e._form_check_uac_log(t),S.looseBody())},_form_check_uac_log:function(t){var e=this,i="",n="";t.status!==_?(1==t.data.spam?(i="trigger_smart_captcha",e.hasInterrupt="spam",t.data.spam_reason&&(e.hasInterruptReason=t.data.spam_reason)):1==t.data.captchav2&&(i="trigger_captcha",e.hasInterrupt="captcha"),n="0"+(e.hasInterruptReason||""),"function"==typeof window.addTetrisAction&&e.submitValueChanged&&e.submitLogId&&window.addTetrisAction({component_type:"form",component_id:e.submitLogId,action_type:i,action_value:n})):t.status==_&&e.hasInterrupt&&("spam"==e.hasInterrupt?i="trigger_smart_captcha":"captcha"==e.hasInterrupt&&(i="trigger_captcha"),n="1"+(e.hasInterruptReason||""),"function"==typeof window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:e.submitLogId,action_type:i,action_value:n}))},validateCallback:function(t){var e=this;if(!t.data.formSubmitCheck)for(var i=e.$el.find("input,select,textarea"),n=i.length,a=0;a<n;a++){var o,r=i.eq(a).attr("name");o=i.eq(a).parent("div.m-input-text").length>0?i.eq(a).parent().prev():i.eq(a).prev();var s="";if(void 0!==t.data[r]){if(t.data[r]?s=o.text()+t.data[r]:""==t.data[r]&&(s=o.text()+"不能为空!"),e.isCreativePage()){var c=e.$el.find("#submit-result");c.html(s)}else TTNotice.create($("body"),{content:s,type:1,title:"提交失败",callback:function(){e.failedUrl&&(window.location.href=e.failedUrl)}});return errTxt=o.text()+" "+i.eq(a).prop("tagName")+" "+S.chinese2English(t.data[r]),void e.trackSubmitLog(t,null,errTxt)}}},formSuccessAlertOrJump:function(){var t=this;if(t.recommendAdPageUrl)return void(window.location.href=t.recommendAdPageUrl);if(t.isLayerForm){var e=t.$layerWrapper;e.find(".form-extra-elements-wrapper"),e.find(".notice-part");if(t.firstHasSubmit&&!t.layerHasSubmit)return e.removeClass("hide"),void S.fixedBody();t.layerHasSubmit&&(e.addClass("hide"),S.looseBody())}if(t.successUrl){var i=/tetris\/page\/index\/(\d{6})\/?\d*/,n=/(.*page\/)index\/\d{6}\/?/;if(i.test(t.successUrl)){var a=t.successUrl.match(i)[1],o=GLOBAL_VAR.pageid_map[a],r=t.successUrl.match(n)[1];GLOBAL_VAR.pageid_map&&(t.successUrl=r+o+"/")}}if(t.isCreativePage()){var s=t.$el.find("#submit-result");s.html(""),toutiao.formDialogClose({submit_result:1,success:function(t){console.log("success: "+JSON.stringify(t))},fail:function(t){console.log("fail: "+JSON.stringify(t))},error:function(t){console.log("error: "+JSON.stringify(t))}})}else{var c=t.successmsg||"表单提交成功!";TTNotice.create($("body"),{content:c,title:"提交成功",callback:function(){t.successUrl&&(window.location.href=t.successUrl)}}),setTimeout(function(){t.successUrl&&(window.location.href=t.successUrl)},2e3);for(var l=t.$el.find(".style2-placeholder"),d=0;d<l.length;d++)l[d].style.display="block"}},getCodeByName:function(t){for(var e=this.city.length,i=0;i<e;i++){var n=this.city[i];if(0===n.name.indexOf(t))return n.code}return!1},getListByCode:function(t){for(var e=[],i=this.city.length,n=0;n<i;n++){var a=this.city[n];0===a.code.toString().indexOf(t)&&e.push(a)}return e},initCity:function(t){var e=this.getCodeByName(t),i=this.getListByCode(e),n=this.$city.find("#city"),a="";n.children().remove();var o=i.length;o>1&&(i.shift(),o--);for(var r=0;r<o;r++){var s=i[r].name.split("|")[0];a+="<option>"+s+"</option>"}n.append(a)},renderCount:function(t){if("true"===this.isShowCount){var e=0===this.countPos?"bottomCount":"topCount";this.$el.parents(".form-piece").find('[data-node="'+e+'"]').css("display","flex"),this.$el.parents(".form-piece").find('[data-node="countTextPre"]').text(t.prefix),this.$el.parents(".form-piece").find('[data-node="countTextNum"]').text(t.middle),this.$el.parents(".form-piece").find('[data-node="countTextPos"]').text(t.subfix)}},initCount:function(){if("true"===this.isShowCount){var t=this;$.get(a,{form_id:this.formId},function(e){e=e||{},e.status===_&&(t.countKit.middle=t.countKit.middle+parseInt(e.count,10),t.renderCount({prefix:t.countKit.prefix,middle:t.countKit.middle,subfix:t.countKit.subfix}))})}},addCount:function(){this.firstHasSubmit&&!this.layerHasSubmit&&(this.countKit.middle=this.countKit.middle+1,this.renderCount({prefix:this.countKit.prefix,middle:this.countKit.middle,subfix:this.countKit.subfix}))},renderRecentSubmitHistory:function(){if(this.recentSubmitStyle=+this.recentSubmitStyle,this.recentSubmitStyle){var t=this,e=[],i=t.$el.parent().find(".recent-submit-content");i.addClass("style"+t.recentSubmitStyle);var n=i.find(".swiper-container"),a=$('<div class="swiper-wrapper"></div>');n.append(a);var o=function(e){if(e){i.removeClass("hide"),e.forEach(function(t){var e;e=t.city?$('<li class="recent-submit-item fourcol swiper-slide">                        <span class="text name"></span>                        <span class="text phone"></span>                        <span class="text city"></span>                        <span class="text time"></span></li>'):$('<li class="recent-submit-item threecol swiper-slide">                        <span class="text name"></span>                        <span class="text phone"></span>                        <span class="text time"></span></li>'),e.find(".name").text(t.name),e.find(".phone").text(t.phone),e.find(".city").text(t.city),e.find(".time").text(t.time),a.append(e)});var o=function(){return 1==t.recentSubmitStyle?4:1}();new Swiper(n[0],{autoplay:2e3,loop:!0,direction:"vertical",simulateTouch:!1,touchMoveStopPropagation:!1,noSwiping:!0,speed:732,slidesPerView:o,onSetTransition:function(t){t.disableTouchControl()}})}};if(t.recentSubmitStyle){$.ajax({url:"/tetris/form/recent_submit/",type:"GET",data:{form_id:t.formId},success:function(t){t.data&&(e=t.data)},complete:function(){var i;1==t.recentSubmitStyle&&(i=8),2==t.recentSubmitStyle&&(i=3);try{e=t.completeRecentList(e,i),o(e)}catch(t){console.error("Error when rendering recent records",t)}}})}}},completeRecentList:function(t,e){var i=t.length;if(i>=e)return t;var n=this.generateNewRecentRecord(e-i),a=n.concat(t);return a=a.sort(function(t,e){return parseInt(t.time)-parseInt(e.time)})},generateNewRecentRecord:function(t){function e(t){for(var e=o.$el.find("[city-data]"),i=e.attr("city-data"),n=JSON.parse(i),a=n.cities.map(function(t){return t.split("|")[0]}),r=a.length,s=[],c=0;c<t;c++){var l=a[Math.floor(Math.random()*r)];s.push(l)}return s}function i(t){for(var e=[],i=0;i<t;i++){var n=Math.floor(60*Math.random());e.push(n)}return e=e.sort(function(t,e){return t-e}),e=e.map(function(t){return""+t+"分钟前"})}function n(t){for(var e=["135","136","137","138","139","150","151","152","158","159","178","182","183","184","187","188","130","131","132","145","155","156","166","175","176","185","186","133","149","153","173","177","180","181","189","199"],i=e.length,n=[],a=0;a<t;a++){var o=""+e[Math.floor(Math.random()*i)]+Math.floor(10*Math.random()),r=""+Math.floor(1e3*Math.random());if(r.length<3)for(var s=0;s<3-r.length;s++)r="0"+r;n.push(o+"****"+r)}return n}function a(t){for(var e=["张","王","李","刘","陈","杨","黄","赵","吴","周","徐","孙","马","朱","胡","郭","何","高","林","郑","谢"],i=["先生","女士"],n=e.length,a=[],o=0;o<t;o++){var r=e[Math.floor(Math.random()*n)],s=i[Math.floor(2*Math.random())];a.push(r+s)}return a}var o=this,r=this.$el.find("[city-data]").length>0,s=a(t),c=n(t),l=i(t);if(r)var d=e(t);for(var u=[],f=0;f<t;f++){const t={name:s[f],phone:c[f],time:l[f]};r&&(t.city=d[f]),u.push(t)}return u},trackSubmitLog:function(t,e,i){var n=this;if(t.status===_){if("function"==typeof window.addTetrisAction){let t={component_type:"form",component_id:n.formId,action_type:"success",action_value:C.isLayerSubmitClicked(e)?"layer":"normal"};window.addTetrisAction(t)}}else t.status===b&&"function"==typeof window.addTetrisAction&&window.addTetrisAction({component_type:"form",component_id:n.formId,action_type:"error",action_value:i})},makeCountDownBtn:function(t){var e=this;if(!t.hasClass("disabled")){var i=59,n=t.find(".text").text();t.attr("origin-text",n),t.addClass("disabled"),t.children(".timer").text("("+i--+")"),t.children(".text").text("重新获取");var a=e.btnTimer=setInterval(function(){t.children(".timer").text("("+i--+")"),i<=-1&&(t.children(".timer").text(""),t.children(".text").text(n),clearInterval(a),t.removeClass("disabled"))}.bind(this),1e3)}},clearCountDownBtn:function(t){var e=this;clearInterval(e.btnTimer),t.children(".text").text(t.attr("origin-text")),t.children(".timer").text(""),t.removeClass("disabled")},addFirstFormMask:function(){},_finishSubmit:function(t){var e=this,i=function(){e.$reset.click(),e.firstHasSubmit=0,e.layerHasSubmit=0,$.each(e.$el.find("input[type=hidden]"),function(){var t=$(this);e.isCreativePage()||/^\d+/.test(t.attr("name"))&&t.val(""),e.$el.find(".showing:not(.select-list1)").removeClass("showing").hide(),e.$city&&e.$city.length&&e.initCity(e.$city.find("#pro").val()),e.prepareToSubmitData="",e.submitedFormData="",localStorage.setItem(y,+new Date)})};e.isLayerForm?e.layerHasSubmit?(i(),$(document.body).append(e.$layerWrapper)):e.firstHasSubmit&&e.addFirstFormMask():i()},observeDOMHeight:function(){var t=this,e=new MutationObserver(function(){var e=t.$el.height(),i=e-t.DOMHeight;0!==i&&(t.DOMHeight=e,t.$el.trigger("DOMHeightChange",[i]))});e.observe(this.$el.get(0),{childList:!0,subtree:!0})}};$.extend(n.prototype,x),e.init=function(t){t.$el=$(t.id);var e=new n(t);return e}});
//# sourceMappingURL=//tosv.byted.org/obj/ad-tetris-uploadpsd/landing_sourcemaps/4030b1b//script.landing_54511d5.js.map
